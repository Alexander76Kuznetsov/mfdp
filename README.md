# Трек 5. Персонализированный рекомендательный движок для ритейла

**ML-задача:** предсказание актуальных для пользователя групп товаров на основании истории пользователя и метаинформации о нем и объявлениях.

**Тип задачи:** многоклассовая классификация или multi-label классификация.

**Целевая переменная:** список (или вероятность) релевантных групп товаров.

**Особенности:**
* История взаимодействий пользователя (просмотры, клики, покупки).
* Метаинформация о пользователе (гео, возраст, пол, интересы, время активности и т. п.).
* Метаинформация об объявлениях (цена, категория, описание, бренд, регион, теги).

**Данные:**
* text_features.pq - вектора текстов объявлений.
* cat_features.pq - фичи объявлений.
* clickstream.pq - история взаимодействия пользователей с объявлениями.
* events.pq - информация о типах событий.


## 1.  Бизнес-анализ (Business Understanding)
**Оргструктура:**\
Заказчиком и пользователем сервиса является компания Авито. Задача поставлена в рамках хакатона [Avito ML Cup 2025](https://ods.ai/competitions/avitotechmlchallenge2025).

**Контакты:**\
Чат участников для обсуждения вопросов:
https://t.me/+qCniQZm_27BjNWYy

**Бизнес-цель:**\
Исследование различных подходов к рекомендациям категорий товаров для увеличения CTR.

**Существующие решения:**\
На данный момент компании предложено более 100 возможных решений. Внедрение нового алгоритма рекомендаций планируется начать в июне, поэтому до 28 мая необходимо разработать наиболее качественную рекомендательную систему.


#### 1.1 Текущая ситуация (Assessing current solution)
* По предварительным расчетам железа хватает.
* Данные предоставлены компанией-заказчиком в обезличенном виде.
* Компания не анонсировала никаких встреч, но консультаций есть широкий круг единомышленников. К тому же заказчик предоставил четкое ТЗ – этого должно хватить.

**Риски:**
* *Риск:* не уложиться в сроки. \
  *Шаги к предотвращению:*
    1.	Уточнить требования заранее — зафиксировать MVP.
    2.	Еженедельная проверка сроков (burn down chart, velocity).
    3.	Использовать таск-трекеры: Jira, Trello, Asana и т.п.
    4.	Настроить дашборд с метриками: прогресс, скорость, блокеры.
* *Риск:* низкое качество полученного сервиса.\
  *Шаги к предотвращению:*
    1.	Определить ключевые метрики.
    2.	User testing на ранних стадиях.
* *Риск:* высокая конкуренция.\
  *Шаги к предотвращению:*
    1.	Разработать альтернативный сценарий использования сервиса.
    2.	Выбрать более узкую нишу.
    3.	Изучить SOTA-решения, а также мониторить новые подходы.


#### 1.2 Решаемые задачи с точки зрения аналитики (Data Mining goals)
* Метрика, на которую будет смотреть заказчик - Recall@40.
* На данный момент лучшие решения показывают метрику 0,16–0,19. Следовательно, наше решение должно продемонстрировать значение Recall@40 > 0,19.
* Если не использовать Recall@40, то можно оценить сервис экспертно или провести A/B.


#### 1.3 План проекта (Project Plan)
**Этап 1. Бизнес-анализ (Business Understanding)**\
*Цель:* определить, что нужно бизнесу и как ML-модель может в этом помочь.\
*Действия:*
* Формулировка бизнес-проблемы.
* Определение метрики успеха.
* Уточнение ограничений.
* Выбор формата модели: top-N категорий, вероятность покупки.

**Этап 2. Анализ данных (Data Understanding)**\
*Цель:* понять, что есть в данных, насколько они пригодны для задачи.\
*Действия:*
* Скачивание предоставленных данных.
* Анализ распределений, аномалий, пропусков, сезонности.
* Визуализация — сколько категорий, активных пользователей, плотность взаимодействий.
* Анализ связи между метками и признаками.

**Этап 3. Подготовка данных (Data Preparation)**\
*Цель:* привести данные к виду, в котором их можно подать в ML-модель.\
*Действия:*
* Очистка данных: удаление выбросов, дубликатов, работа с пропущенными значениями.
* Генерация признаков:
  * по пользователю (например, история категорий, поведение),
  * по товарам (цена, текст, популярность),
  * взаимодействия (время, клик, глубина просмотра).
* Векторизация текстов (TF-IDF, BERT).
* Кодирование категорий (OneHot, Target Encoding).
* Деление выборки по времени (train / valid / test).

**Этап 4. Моделирование (Modeling)**\
*Цель:* обучить и выбрать модель, которая будет делать качественные предсказания.\
*Действия:*
* Подбор алгоритмов: логистическая регрессия, XGBoost, CatBoost, LightGBM, нейросети.
* Кросс-валидация и подбор гиперпараметров.
* Обработка multi-label (One-vs-Rest, ranking, классификация top-N).
* Построение ансамблей или стэкинга (если нужно).
* Логгирование и контроль экспериментов (например, через MLflow).

**Этап 5. Оценка результата (Evaluation)**\
*Цель:* убедиться, что модель действительно решает бизнес-задачу.\
*Действия:*
* Сравнение метрик модели с бизнес-целями (uplift CTR).
* A/B тест на части пользователей (если будет интегрировано).
* Анализ ошибок: где рекомендации не сработали, почему.
* Разделение результатов по сегментам пользователей.

**Этап 6. Внедрение (Deployment)**\
*Цель:* интегрировать модель в реальный продукт.\
*Действия:*
* Оборачивание модели в API / сервис.
* Настройка пайплайна обновления данных (ETL, Spark, Airflow).
* Мониторинг качества: логгирование, алерты, деградация модели.
* Документация и обучение команды сопровождения.

